# 战斗系统

## 流程
1. 主角和主角的[随从](./character#随从)，敌人和敌人的[随从](./character#随从)进入战斗
2. 系统将主角队随机排序
3. 系统将敌人队随机排序
4. 系统将敌人队和主角队交错排序
5. 依据排好的队列依次行动
6. 全部行动完后回到步骤1，进入下一回合
7. 当主角生命为0时战斗失败，当敌方首领生命为0时战斗胜利

## 前排
- 前排为战斗中双方的前排单位。
- 当一个战斗单位发动非暗器或心法类的[技能](./spell.html)时，会替换并成为前排。
- [技能](./spell.html)的目标总是对方的前排（含aoe效果的技能依旧可以攻击到对方后排单位）。
- 战斗刚开始前排默认为主角和敌方首领

## 当前技能
- 当发动[技能](./spell.html)时，人物会将当前技能替换成此次发动的技能
- 当己方人物遭攻击时，会使用当前技能的招架值+自身护甲值抵消伤害。
- 如果敌方发动非暗器或心法类技能则己方[前排](#前排)发动当前技能反击

## 死斗
- 当战斗在[剧情元素](./act-element.html)：[战斗](./act-element.html#切换主角)中设为死斗时，人物血量为0会发动触发条件为濒死的被动，发动完毕后如人物血量仍为0则人物死亡
- 当战斗不为死斗时，人物血量为0不会发动触发条件为濒死的被动，也不会导致人物死亡
